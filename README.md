# UUPSUpgradeable Vulnerability

## Description

This agent detects a [vulnerability in UUPSUpgradeable proxy](https://forum.openzeppelin.com/t/uupsupgradeable-vulnerability-post-mortem/15680) contracts.

The vulnerability lies in the `DELEGATECALL` instructions in the upgrade function, exposed by the `UUPSUpgradeable` base contract. A `DELEGATECALL` can be exploited by an attacker by having the implementation contract call into another contract that SELFDESTRUCTs itself, causing the caller to be destroyed.

## Supported Chains

- Ethereum
- Rinkeby
- List any other chains this agent can support e.g. BSC

## Alerts

Describe each of the type of alerts fired by this agent

- UUPS_PROXY-1
  - Fired when an `upgradeToAndCall` function is called and the code of the contract that received the execution it is empty
  - Severity is always set to `critical` since it breaks the proxy functionality 
  - Type is always set to `exploit`
  - Additional metadata fields:
    - `attacker`: the address which performed the attack operation
    - `contractAttacker`: the address of the contract used to `selfdestruct` the implementation contract and left it without code


## Test Data

The agent behavior can be verified with the following transactions:

- 0x095849083eaad79ea35caf1cd1eed92ad48c668f23edab68d78f94095200098c (rinkeby)